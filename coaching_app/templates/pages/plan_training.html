{% extends "base.html" %}

{% block content %}
<!-- TODO schöner gestalten und UI verbessern -->
    <div class="container-md ps-5 pe-5">
        <div class="row">
            <div class="col text-center m-2 p-2 pb-0">
                <h2 class="text-uppercase fw-bold">Training planen</h2>
            </div>
        </div>
    </div>

    <form action="{% url 'training_overview' %}" method="post">
        {% csrf_token %}
        
        <!-- Datum auswählen -->
        <div class="row mb-3">
            <div class="col-1"></div>
            <div class="col-10">
                <label for="date" class="form-label">Datum wählen</label>
                <input
                    type="date"
                    class="form-control"
                    id="date"
                    name="date"
                    value="{% if training %}{{ training.date|date:'Y-m-d' }}{% else %}{{ today|date:'Y-m-d' }}{% endif %}"
                >
            </div>
            <div class="col-1"></div>
        </div>

        <!-- Drills auswählen -->
         <div class="row mb-3">
            <div class="col-1"></div>
            <div class="col-5 d-flex">
                <button 
                    type="button"   
                    class="btn btn-dark custom-nav-btn flex-grow-1"
                    onclick="openPopUp(this, 'list')">Drills auswählen</button>
            </div>
            <div class="col-5 d-flex">
                <button 
                    type="button" 
                    class="btn btn-dark custom-nav-btn flex-grow-1">Custom Slot</button>
            </div>
            <div class="col-1"></div>
        </div>
        
        <!-- Drag and Drop Area für Planung -->
        <!-- HIER WEITERMACHEN -->
        <div class="row mb-3">
            <div class="col-1"></div>
            <div class="col-10" id="sortable">
                <li data-id="1">Eintrag A</li>
                <li data-id="2">Eintrag B</li>
                <li data-id="3">Eintrag C</li>
            </div>
            <div class="col-1"></div>
        </div>

        <!-- Submit Training -->
        <div class="row mb-3">
            <div class="col-1"></div>
            <div class="col-10">
                <button 
                    type="submit" 
                    class="btn btn-primary" 
                    name="action" 
                    value="{% if training %}update{% else %}create{% endif %}"
                >{% if training %}Training aktualisieren{% else %}Training erstellen{% endif %}</button>
            </div>
            <div class="col-1"></div>
        </div>
    </form>

    <!-- Ebene 1 -->
    <div class="pop-up-background" id="PopUpBg"></div>
    <div class="pop-up-content" id="PopUpList"></div>

{% endblock %}

{% block scripts %}
<script>
  const sortable = new Sortable(document.getElementById('sortable'), {
    animation: 150,
    onEnd: function () {
      const order = [...document.querySelectorAll('#sortable li')]
        .map(li => li.dataset.id);

      console.log(order); // neue Reihenfolge
    }
  });
</script>
{% endblock %}